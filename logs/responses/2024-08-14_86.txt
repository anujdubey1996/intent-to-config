
Create a Kubernetes deployment workload configuration file based on the provided intent.

Intent: Deploy a single instance of the Consul service on Kubernetes with the appropriate configurations for ports, resources, and Istio sidecar monitoring.

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: consul
  labels:
    app: consul
spec:
  replicas: 1
  selector:
    matchLabels:
      app: consul
  template:
    metadata:
      labels:
        app: consul
    spec:
      containers:
      - name: consul
        image: hashicorp/consul:latest
        ports:
        - name: HTTP
          containerPort: 8500
          protocol: TCP
          targetPort: 8500
        - name: SERVICEDISCOVERY
          containerPort: 8501
          protocol: TCP
          targetPort: 8501
        - name: DNS
          containerPort: 53
          protocol: UDP
        - name: DNS
          containerPort: 53
          protocol: TCP
        - name: RFT
          containerPort: 8600
          protocol: TCP
        - name: Gossip
          containerPort: 8651
          protocol: TCP
        resources:
          requests:
            cpu: 500m
            memory: 128Mi
          limits:
            cpu: 1000m
            memory: 256Mi
        readinessProbe:
          tcpSocket:
            port: 8600
          initialDelaySeconds: 5
        livenessProbe:
          tcpSocket:
            port: 8600
          initialDelaySeconds: 60
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringScale:
          - labelSelector:
              matchExpressions:
              - key: app
                operator: In
                values:
                - consul
            preferredDuringSchedulingIgnoredDuringScale:
            - preference:
                matchExpressions:
                - key: app
                  operator: In
                  values:
                  - consul
                weight: 100
      tolerations:
      - operator: Exists
        effect: NoSchedule
        tolerationSeconds: 300

---
apiVersion: networking.k8s.io/v1
kind: Service
metadata:
  name: consul
spec:
  type: LoadBalancer
  selector:
    app: consul
  ports:
  - name: http
    port: 8500
    targetPort: 8500
  - name: rft
    port: 8600
    targetPort: 8600

---
apiVersion: autoscaling/v2beta2
kind: HorizontalPodAutoscaler
metadata:
  name: consul
spec:
  maxReplicas: 10
  minReplicas: 1
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: consul
  targetCPUUtilizationPercentage: 50
```

This YAML file creates a deployment for Consul with a single replica, exposes the service on a LoadBalancer, and includes autoscaling support based on CPU utilization. It also sets up the necessary ports, resources, and probes for the Consul container. The Istio sidecar injection is not included in this example as it requires separate configuration settings for the service mesh.